/* ======== Mobile-first UI layer (TikTok-like feed) ======== */
@media (max-width: 768px){
  /* base */
  html, body { height: 100%; overflow-x: hidden; }

  /* ===== Mobile overlay ===== */
  .mobile-feed{
    position: fixed;
    inset: 0;
    z-index: 2147483000;             /* above everything */
    display: grid !important;        /* force visible when present */
    grid-template-rows: 1fr auto;    /* feed + bottom nav */
    background: var(--bg, #0f1115);
    color: var(--fg, #e6e8ef);
  }

  /* feed scaffold */
  .m-feed-scroll{
    height: calc(100vh - 64px);      /* minus bottom nav */
    overflow-y: auto;
    scroll-snap-type: y mandatory;
  }

  .m-card{
    position: relative;
    height: calc(100vh - 64px);
    scroll-snap-align: start;
    display: grid;
    grid-template-rows: 1fr auto;
    border-bottom: 1px solid var(--line, #1d2230);
  }

  .m-card-media{
    display: grid;
    place-items: center;
    overflow: hidden;
  }
  .m-card-media img{
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
    -webkit-user-drag: none;
    user-select: none;
  }

  /* meta (bottom-left overlay) */
  .m-card-meta{
    position: absolute;
    left: 12px; right: 76px; bottom: 84px;
    display: grid; gap: 6px;
    pointer-events: none;
    text-shadow: 0 2px 10px rgba(0,0,0,.5);
  }
  .m-title{ font-weight: 700; font-size: 18px; line-height: 1.2; }
  .m-tags{ display: flex; flex-wrap: wrap; gap: 6px; }
  .m-tag{
    font-size: 12px; padding: 4px 8px; border-radius: 999px;
    background: rgba(255,255,255,.08);
    border: 1px solid rgba(255,255,255,.12);
  }

  /* right-side actions */
  .m-actions{
    position: absolute;
    right: 8px; bottom: 90px;
    display: grid; gap: 14px;
    justify-items: center;
  }
  .m-action{
    width: 56px; height: 56px;
    border-radius: 16px;
    background: rgba(0,0,0,.35);
    backdrop-filter: blur(6px);
    display: grid; place-items: center;
    font-size: 22px;
    border: 1px solid rgba(255,255,255,.1);
  }
  .m-action.is-disabled{ opacity: .4; filter: grayscale(1); }
  .m-action-label{ font-size: 12px; opacity: .9; margin-top: 2px; }

  /* bottom nav */
  .m-nav{
    position: sticky; bottom: 0;
    height: 64px;
    background: rgba(0,0,0,.6);
    backdrop-filter: blur(8px);
    border-top: 1px solid rgba(255,255,255,.12);
    display: grid; grid-template-columns: repeat(4, 1fr);
    padding-bottom: env(safe-area-inset-bottom);
  }
  .m-nav button{
    background: transparent; color: var(--fg, #e6e8ef);
    border: 0; display: grid; gap: 4px; place-items: center;
    padding: 8px 0; font: inherit;
  }
  .m-nav button[aria-current="page"]{ font-weight: 700; }

  /* toast */
  .m-toast{
    position: fixed; left: 50%; bottom: 80px; transform: translateX(-50%);
    background: rgba(20,20,24,.9);
    color: #fff; padding: 10px 14px; border-radius: 10px;
    opacity: 0; pointer-events: none; transition: opacity .25s ease;
  }
  .m-toast.show { opacity: 1; }

  /* ===== Desktop suppression (allow overlays) ===== */
  body.mobile-active { overflow: hidden; }
  body.mobile-active .topbar,
  body.mobile-active #filters,
  body.mobile-active .page,
  body.mobile-active #detailView,
  body.mobile-active .footer{
    display: none !important;
  }

  /* If any app overlay is open, hide the mobile layer instead */
  body.overlay-open .mobile-feed{ display: none !important; }

  /* ===== Detail view mobile tweaks ===== */
  /* Hide chips/tags & content rating on mobile */
  #detailTags,
  #detailRating { display: none !important; }

  /* Stop left shift when switching thumbnails */
  #detailThumbs img,
  #detailThumbs img.active { transform: none !important; }

  /* Keep selection highlight without changing layout width */
  #detailThumbs img{ box-sizing: border-box; }
  #detailThumbs img.active{
    border-width: 0 !important;
    outline: 2px solid var(--accent, #6aa0ff) !important;
    outline-offset: 0;
  }

  /* Stable horizontal scrolling for thumb rail */
  #detailThumbs{
    gap: 8px;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scroll-snap-type: x proximity;
  }
  #detailThumbsWrap{ overflow: hidden; }
}
