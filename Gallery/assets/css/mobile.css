/* =========================================================================
   Prompt Vault — Mobile UI (CSS-only, clean build: SAFE)
   ========================================================================= */
@media (max-width: 768px){

  /* ------------------ Shell / base ------------------ */
  :root { --m-nav-h: 56px; }

  html, body { background:#000; color:#e8e8e8; }

  body.mobile-on { overflow:hidden; background:#000; }
  body.mobile-on .topbar,
  body.mobile-on #filters,
  body.mobile-on .footer { display:none !important; }

  body.mobile-on .page{
    height: calc(100vh - var(--m-nav-h));
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
    background:#000;
  }

  /* ===================== RESULTS (cards list) ===================== */
  .results { background:#000; }

  .results .grid{
    grid-template-columns: 1fr !important;
    gap:10px !important;
    padding:10px;
    background:#000;
    -webkit-overflow-scrolling: touch;
  }

  /* Covers: keep them visible */
  .results .grid img{
    width:100%;
    height:auto;
    display:block;
    object-fit:cover;
    background:#000;
  }

  /* ---------- ONLY remove the counter strip (thumb-wrap without an IMG) ---------- */
  .results .grid > * > .thumb-wrap:not(:has(img)){
    margin:0 !important;
    padding:0 !important;
    border:0 !important;
    height:0 !important;
    min-height:0 !important;
    overflow:hidden !important;
    background:transparent !important;
  }
  .results .grid > * > .thumb-wrap:not(:has(img)) *{
    display:none !important;
  }

  /* With the strip gone, pull the actions up a bit */
  .results .grid > * > .thumb-wrap:not(:has(img)) + .card-actions,
  .results .grid > * > .thumb-wrap:not(:has(img)) + .actions,
  .results .grid > * > .thumb-wrap:not(:has(img)) + .buttons{
    margin-top:8px !important;
  }

  /* Title under the cover, centered & compact */
  .results .grid [class*="title"], .results .grid h2, .results .grid h3{
    margin:8px 12px 6px !important;
    padding:0 !important;
    text-align:center !important;
    font-weight:700 !important;
    font-size:16px !important;
    color:#fff !important;
    display:block !important;
  }

  /* Action buttons tight under title */
  .results .grid .actions,
  .results .grid [class*="actions"],
  .results .grid .buttons{
    margin:8px 12px 12px !important;
    gap:10px;
  }
  .results .grid .actions .btn,
  .results .grid [class*="actions"] .btn,
  .results .grid .buttons .btn{
    min-height:44px; border-radius:12px;
  }

  /* Hide chips/tags/labels/counters anywhere else on cards (safe, specific) */
  .results .grid .chips,
  .results .grid .tags,
  .results .grid .tag-list,
  .results .grid [class*="tag" i],
  .results .grid .image-count,
  .results .grid .counts,
  .results .grid .count,
  .results .grid .labels,
  .results .grid .meta-tags { display:none !important; }

  /* ===================== DETAIL VIEW ===================== */

  #detailView[aria-hidden="false"],
  body.mobile-on #detailView:not([aria-hidden="true"]) {
    position:fixed !important; inset:0 !important; z-index:9999 !important;
    display:grid !important; grid-template-rows:auto 1fr auto;
    background:#000; padding-bottom:var(--m-nav-h);
    overflow-y:auto; -webkit-overflow-scrolling:touch; touch-action:pan-y;
  }

  /* Order: hero first, then caption strip */
  #detailView .detail-gallery{ grid-row:1; position:relative; overflow:hidden; background:#000; }
  #detailView .detail-header { grid-row:2; }

  #detailView #detailHero{
    height: calc(100vh - 150px);
    display:grid; place-items:center; background:#000;
  }
  #detailView #detailImg{ width:100%; height:100%; object-fit:contain; background:#000; }

  /* Caption strip (Back | Actions) — title hidden per spec */
  #detailView .detail-header{
    position:relative; z-index:2; display:grid;
    grid-template-columns: minmax(0,1fr) auto;
    align-items:center; padding:8px 12px;
    background:rgba(0,0,0,.70); backdrop-filter:blur(8px);
    border-top:1px solid rgba(255,255,255,.06);
    border-bottom:1px solid rgba(255,255,255,.06);
  }
  #detailView #detailBack{
    grid-column:1; justify-self:center;
    display:inline-flex !important; align-items:center; gap:8px;
    padding:6px 12px; min-height:36px; white-space:nowrap;
    border:0; border-radius:10px; color:#fff; font-size:15px; line-height:1.2;
    background:rgba(255,255,255,.10);
    box-shadow:inset 0 0 0 1px rgba(255,255,255,.08);
  }
  #detailView #detailBack::before{ content:none !important; } /* use "← Back" in label */

  #detailView .detail-title-area,
  #detailView #detailTitle{ display:none !important; }

  #detailView .detail-actions{
    grid-column:2; justify-self:center;
    display:inline-grid; grid-auto-flow:column; gap:8px; align-items:center;
  }
  #detailView .detail-actions .btn{
    background:rgba(255,255,255,.10); color:#fff; border:0; border-radius:10px;
    padding:6px 12px; min-height:36px;
  }

  /* Hide tags/chips in detail */
  #detailView #detailTags,
  #detailView .chips,
  #detailView .tags,
  #detailView [class*="tag" i]{ display:none !important; }

  /* Thumbs strip */
  #detailView #detailThumbsWrap{
    position:sticky; bottom:0;
    background:linear-gradient(to top, rgba(0,0,0,.85), rgba(0,0,0,0));
    padding:8px 6px 4px; z-index:3;
  }
  #detailView #detailThumbs{
    display:grid !important; grid-auto-flow:column; grid-auto-columns:max-content;
    align-items:center; gap:10px; overflow-x:auto; -webkit-overflow-scrolling:touch;
    scrollbar-width:none; touch-action:pan-x;
  }
  #detailView #detailThumbs::-webkit-scrollbar{ display:none; }
  #detailView #detailThumbs .m-item,
  #detailView #detailThumbs .thumb,
  #detailView #detailThumbs .m-thumb-wrap{
    padding:0 !important; margin:0 !important; width:96px !important; height:96px !important;
    border-radius:12px !important; overflow:hidden !important; background:#0b0b0b !important;
  }
  #detailView #detailThumbs img,
  #detailView #detailThumbs .m-thumb{
    width:100% !important; height:100% !important; display:block !important;
    object-fit:cover !important; border-radius:12px !important; transform:none !important;
    background:#000 !important;
  }
  #detailView #detailThumbs img.active,
  #detailView #detailThumbs .m-thumb.active{
    outline:2px solid #5ca8ff !important; outline-offset:2px !important;
  }

  /* Prompt text area */
  #detailView .detail-prompt{
    max-height:40vh; overflow:auto; background:#0a0a0a;
    border-top:1px solid rgba(255,255,255,.08); padding:10px 12px;
  }

  /* ===================== GALLERY (2-per-row) ===================== */
  #galleryView[aria-hidden="false"]{
    position:fixed !important; inset:0 !important; z-index:9999 !important;
    display:grid !important; grid-template-rows:auto 1fr;
    background:#000; padding-bottom:var(--m-nav-h);
  }
  #galleryView .gallery-header{
    position:sticky; top:0; z-index:2;
    background:linear-gradient(to bottom, rgba(0,0,0,.9), rgba(0,0,0,.4));
    padding:10px;
  }
  #galleryGrid{
    overflow-y:auto; padding:10px;
    display:grid; grid-template-columns: repeat(2, 1fr); gap:10px;
    -webkit-overflow-scrolling:touch;
  }
  #galleryGrid img, #galleryGrid .g-img, #galleryGrid .card img{
    width:100%; height:auto; display:block; border-radius:12px; background:#000;
  }
  #gallerySentinel{ pointer-events:none; opacity:.6; }

  /* ===================== Mobile bottom bar ===================== */
  .mbar{
    position:fixed; left:0; right:0; bottom:0; height:var(--m-nav-h);
    background:rgba(0,0,0,.84); backdrop-filter:blur(10px);
    border-top:1px solid rgba(255,255,255,.08);
    display:grid; grid-template-columns:repeat(4,1fr); z-index:10000;
    padding-bottom: env(safe-area-inset-bottom);
  }
  .mbar button{
    background:transparent; border:0; color:#e8e8e8; font:inherit;
    display:grid; place-items:center; gap:2px;
  }
  .mbar button[aria-current="true"]{ color:#fff; font-weight:700; }

  /* ===================== Hide unsafe / write actions ===================== */
  #detailDownloadImg, #detailAddImages, #detailRating,
  .nsfw-toggle, .content-rating, [data-rating-toggle],
  #newPromptBtn, [data-action="delete"], [data-action="remove"], [data-action="set-cover"],
  [title*="Delete"], [title*="Change main"], [title*="Set as cover"],
  [data-action="download-image"], [data-action="add-images"]{
    display:none !important;
  }

  /* Safe area padding + landscape tweak */
  #detailView, #galleryView, body.mobile-on .page{
    padding-bottom: calc(var(--m-nav-h) + env(safe-area-inset-bottom));
  }
  @media (orientation: landscape){
    #detailView #detailHero{ height: calc(100vh - 170px); }
    #detailView #detailThumbs .m-item,
    #detailView #detailThumbs .m-thumb-wrap{ width:84px !important; height:84px !important; }
    #detailView #detailThumbs img, #detailView #detailThumbs .m-thumb{ border-radius:10px !important; }
  }
/* Preferred: remove the wrapper box entirely */
  @supports (display: contents) {
    .results .grid .thumb-wrap{
      display: contents !important;   /* wrapper no longer adds height */
      padding: 0 !important;
      margin: 0 !important;
      border: 0 !important;
      background: transparent !important;
      height: auto !important;
      min-height: 0 !important;
      line-height: 0 !important;
    }
  }

  /* Fallback for older engines: make the wrapper auto-size to the media */
  @supports not (display: contents) {
    .results .grid .thumb-wrap{
      display: grid !important;
      grid-auto-rows: auto !important;
      padding: 0 !important;
      margin: 0 !important;
      border: 0 !important;
      height: auto !important;
      min-height: 0 !important;
      line-height: 0 !important;
      overflow: hidden !important;
      background: transparent !important;
    }
    .results .grid .thumb-wrap > img,
    .results .grid .thumb-wrap > picture,
    .results .grid .thumb-wrap > video,
    .results .grid .thumb-wrap > canvas,
    .results .grid .thumb-wrap > .thumb,
    .results .grid .thumb-wrap > .m-thumb{
      grid-row: 1;
      display: block !important;
      width: 100% !important;
      height: auto !important;
      margin: 0 !important;
      object-fit: cover !important;
      border-radius: 0 !important;
    }
  }

  /* Regardless of support: hide any non-media content inside thumb-wrap */
  .results .grid .thumb-wrap > :not(img):not(picture):not(video):not(canvas):not(.thumb):not(.m-thumb){
    display: none !important;
    margin: 0 !important;
    padding: 0 !important;
    height: 0 !important;
    min-height: 0 !important;
    border: 0 !important;
  }

  /* Kill pseudo-elements that often provide the ratio spacer */
  .results .grid .thumb-wrap::before,
  .results .grid .thumb-wrap::after{
    content: none !important;
    display: none !important;
  }
  
  /* ===================== DETAIL HEADER: 2 centered buttons ===================== */
/* ============================
   Mobile detail header layout
   Back | Shuffle | Copy on one line
   ============================ */
@media (max-width: 640px) {

  /* Header grid: three cells */
  #detailView .detail-header{
    display:grid !important;
    grid-template-columns: auto 1fr auto;   /* back | center | copy  */
    grid-template-areas: "back shuffle copy";
    align-items:center;
    gap:8px;
    padding:6px 10px !important;
    min-height:56px;
    background: rgba(0,0,0,.70);
    backdrop-filter: blur(8px);
    border-top: 1px solid rgba(255,255,255,.06);
    border-bottom: 1px solid rgba(255,255,255,.06);
  }

  /* Hide title area to save space */
  #detailView .detail-title-area,
  #detailView #detailTitle{
    display:none !important;
  }

  /* Let action buttons become direct grid items */
  #detailView .detail-actions{
    display: contents !important;
  }

  /* Place each control into the grid area */
  #detailView #detailBack{
    grid-area: back;
    justify-self: start;
  }
  #detailView #detailSlideshow{
    grid-area: shuffle;
    justify-self: center;
  }
  #detailView #detailCopyPrompt{
    grid-area: copy;
    justify-self: end;
  }

  /* Hide extra actions on mobile */
  #detailView #detailDownloadImg,
  #detailView #detailAddImages,
  #detailView #detailRating{
    display:none !important;
  }

  /* Uniform compact button style */
  #detailView .detail-header .btn{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:10px 16px !important;
    min-height:40px !important;
    line-height:1.2;
    border:0 !important;
    border-radius:12px !important;
    background: rgba(255,255,255,.10) !important;
    color:#fff !important;
    box-shadow: inset 0 0 0 1px rgba(255,255,255,.08) !important;
  }

  /* Kill leftover margins around header content */
  #detailView .detail-header > *{
    margin:0 !important;
  }

  /* Thumbs a bit larger with tighter padding */
  #detailView #detailThumbsWrap{
    padding:6px 6px 4px !important;
  }
  #detailView #detailThumbs .m-item,
  #detailView #detailThumbs .thumb,
  #detailView #detailThumbs .m-thumb-wrap{
    width:112px !important;
    height:112px !important;
    border-radius:12px !important;
    overflow:hidden !important;
    background:#0b0b0b !important;
  }
  #detailView #detailThumbs img,
  #detailView #detailThumbs .m-thumb{
    width:100% !important;
    height:100% !important;
    object-fit:cover !important;
    border-radius:12px !important;
    transform:none !important;
  }

  /* Give the hero a touch more room with the tighter header */
  #detailView #detailHero{
    height: calc(100vh - 138px);
  }

  /* Ensure page background is solid (no white seams) */
  html, body{
    margin:0;
    background:#000;
    color:#e8e8e8;
    height:100%;
  }
}
}