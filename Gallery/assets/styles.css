:root{
  --bg:#0f1115; --fg:#e6e8ef; --muted:#9aa3b2; --chip:#1b2030; --chipOn:#2e3a57;
  --card:#151925; --accent:#6aa0ff; --line:#1d2230;
}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,system-ui,Segoe UI,Arial,sans-serif;background:var(--bg);color:var(--fg)}
body.no-scroll{overflow:hidden}

/* Topbar: title centered, controls on right */
.topbar{
  display:grid; grid-template-columns:1fr auto 1fr;
  align-items:center; gap:12px;
  padding:12px 16px; border-bottom:1px solid var(--line); position:sticky; top:0; background:var(--bg); z-index:10;
}
.topbar h1{margin:0; font-size:18px; text-align:center}
.left-spacer{min-width:1px}
.actions{justify-self:end; display:flex; gap:8px; align-items:center}
.actions input{padding:8px 10px;border:1px solid var(--line);background:#0b0e13;color:var(--fg);border-radius:8px;min-width:260px}
.actions button{padding:8px 10px;border:1px solid var(--line);background:#0b0e13;color:var(--fg);border-radius:8px;cursor:pointer}

/* Inline filters (replaces sidebar) */
.filters-inline{max-width:1900px;margin:12px auto 0;padding:0 16px}
.filters-row{
  display:flex; align-items:flex-start; justify-content:space-between; gap:16px;
  border:1px solid var(--line); border-radius:12px; padding:12px; background:var(--card);
}
.chips-wrap{display:flex; flex-direction:column; gap:8px; min-width:0; flex:1}
.chips-wrap h2{margin:0; font-size:14px; color:var(--muted)}
.filter-mode{color:var(--muted);font-size:13px; display:flex; gap:12px; align-items:center; white-space:nowrap}

.chips{display:flex;flex-wrap:wrap;gap:6px;align-content:start}
.chips .chip{padding:6px 10px;border-radius:999px;background:var(--chip);color:var(--fg);font-size:12px;border:1px solid var(--line);cursor:pointer;user-select:none}
.chips .chip.active{background:var(--chipOn);border-color:var(--accent)}
.chips.small .chip{font-size:11px;padding:4px 8px}

/* Page container centers the grid */
.page{max-width:1900px;margin:16px auto;padding:0 16px}

/* Results */
.results .results-bar{display:flex;justify-content:space-between;align-items:center;margin:4px 0 10px 0}
.results .stats{color:var(--muted);font-size:13px}
.big-gallery-btn{padding:10px 14px;border-radius:10px;border:1px solid var(--line);background:#0b0e13;color:var(--fg);cursor:pointer;font-weight:600}

/* -------- 5 cards per row without downsizing -------- */
.grid{
  display:grid;
  grid-template-columns:repeat(5, 360px);  /* fixed card width */
  gap:18px;
  justify-content:center;                  /* center whole grid, no horizontal scroll */
  align-items:stretch;
  margin:0 auto;
}

/* Card */
.card{
  border:1px solid var(--line);border-radius:12px;background:var(--card);
  overflow:hidden;display:flex;flex-direction:column;
  min-height:600px;transition:transform .12s, box-shadow .12s, border-color .12s
}
.card:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(0,0,0,.35);border-color:#26304a}

/* Thumbnail */
.thumb-wrap{position:relative;aspect-ratio:3/4;background:#0b0e13;overflow:hidden}
.thumb{width:100%;height:100%;object-fit:cover;display:block;transform:scale(1.03)}
.badge{position:absolute;left:8px;top:8px;background:#121725a8;border:1px solid var(--line);padding:2px 6px;border-radius:6px;font-size:11px;color:var(--muted)}

/* Meta */
.meta{padding:12px 14px;display:flex;flex-direction:column;gap:8px;flex:1 1 auto}
.title{font-size:15px;margin:0 0 2px 0}
.tags{display:flex;flex-wrap:wrap;gap:6px;padding-right:2px}
.tags .tag{font-size:11px;padding:2px 6px;border:1px solid var(--line);border-radius:6px;color:var(--muted)}

/* Actions */
.card-actions{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:10px 12px 12px;border-top:1px solid var(--line);margin-top:auto}
.card-actions button{height:42px;padding:8px;border:1px solid var(--line);background:#0b0e13;color:var(--fg);border-radius:8px;cursor:pointer}
.card-actions button:hover{border-color:#2b3857}

/* Empty */
.empty.hidden{display:none}
.empty{padding:24px;border:1px dashed var(--line);border-radius:12px;text-align:center;color:var(--muted);background:#0b0e13}

/* ---------- MODAL (90% viewport) ---------- */
.fullpage-modal{width:90vw;height:90vh;max-width:none;max-height:none;padding:0;margin:auto;border:none;border-radius:16px;background:var(--bg);color:var(--fg);overflow:hidden}
.fullpage-modal::backdrop{background:#000b}
.icon-close{position:absolute;top:12px;right:14px;height:36px;width:36px;border-radius:999px;border:1px solid var(--line);background:#0b0e13;color:var(--fg);font-size:18px;line-height:34px;text-align:center;cursor:pointer;box-shadow:0 4px 18px rgba(0,0,0,.35);transition:transform .12s, border-color .12s;z-index:3}
.icon-close:hover{transform:translateY(-1px);border-color:#2b3857}
.fp-shell{display:grid;grid-template-columns:minmax(0,1fr) 420px;gap:16px;padding:18px 18px 22px 18px;height:100%}
.fp-media{display:flex;flex-direction:column;gap:10px;min-width:0}
.fp-media img{width:100%;flex:1 1 auto;max-height:calc(90vh - 18px - 22px - 200px);object-fit:contain;background:#0b0e13;border:1px solid var(--line);border-radius:12px}

/* EXIF / meta row */
.img-meta{display:flex;align-items:center;gap:8px;color:var(--muted);font-size:12.5px;padding:4px 2px 2px}
.img-meta .dot{opacity:.65}
.pill.tiny{padding:4px 8px;border-radius:999px;border:1px solid var(--line);background:#0b0e13;color:var(--fg);cursor:pointer;font-size:12px}

/* Preview strip */
.thumbs-row{
  display:flex; flex-wrap:nowrap; align-items:center; gap:12px;
  padding:6px 2px 10px 2px;
  overflow-x:auto; overflow-y:hidden; scroll-behavior:smooth;
  scrollbar-color:#2a3250 #0b0e13;
}
.thumbs-row::-webkit-scrollbar{height:10px}
.thumbs-row::-webkit-scrollbar-track{background:#0b0e13;border-radius:999px}
.thumbs-row::-webkit-scrollbar-thumb{background:#2a3250;border-radius:999px}
.thumbs-row img{
  flex:0 0 auto; width:138px; height:138px; object-fit:cover;
  border:1px solid var(--line); border-radius:10px; cursor:pointer;
  opacity:.96; transition:transform .12s, outline-color .12s;
}
.thumbs-row img:hover{transform:translateY(-1px)}
.thumbs-row img.active{outline:2px solid var(--accent);outline-offset:1px;opacity:1}

/* Preview scrubber */
.thumb-scrub{ -webkit-appearance:none; appearance:none; width:100%; height:28px; background:transparent; margin:4px 0 0; }
.thumb-scrub:focus{outline:none}
.thumb-scrub::-webkit-slider-runnable-track{height:6px;background:#1b2640;border-radius:999px}
.thumb-scrub::-webkit-slider-thumb{-webkit-appearance:none;margin-top:-8px;height:22px;width:22px;border-radius:50%;background:#6aa0ff;border:2px solid #2b3857}
.thumb-scrub::-moz-range-track{height:6px;background:#1b2640;border-radius:999px}
.thumb-scrub::-moz-range-thumb{height:22px;width:22px;border-radius:50%;background:#6aa0ff;border:2px solid #2b3857}

/* Right column */
.fp-info{display:flex;flex-direction:column;gap:12px;min-width:0}
.fp-info h3{margin:0;font-size:18px}
.prompt-pre.block{white-space:pre-wrap;padding:12px;background:#0b0e13;border:1px solid var(--line);border-radius:12px;font-size:12.5px;line-height:1.45;max-height:none;overflow:visible}
.fp-actions{display:flex;gap:10px;justify-content:flex-end}

/* Pretty primary button + success flash */
.btn{padding:10px 14px;border-radius:10px;border:1px solid var(--line);background:#0b0e13;color:var(--fg);cursor:pointer;font-weight:600;transition:transform .12s, box-shadow .12s, border-color .12s, background .12s, color .12s}
.btn:hover{transform:translateY(-1px);border-color:#2b3857}
.btn:active{transform:translateY(0)}
.btn-primary{background:linear-gradient(180deg,#1a2238,#12182b)}
.btn-primary:hover{border-color:#3a4a7a}
.btn-primary.is-ok{background:linear-gradient(180deg,#1d3b21,#112416);border-color:#2b6f3b;color:#b8ffcc;box-shadow:0 0 0 3px rgba(60,200,120,.18) inset}

/* --- Image count bubble (bottom-left of thumbnail) --- */
.count-badge{
  position:absolute;
  left:8px;
  bottom:8px;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid var(--line);
  background:rgba(0,0,0,.50);
  color:var(--muted);
  font-size:11px;
  line-height:16px;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  user-select:none;
}


/* Compare overlay */
.compare{position:absolute; inset:0; background:rgba(0,0,0,.55); backdrop-filter:blur(2px); -webkit-backdrop-filter:blur(2px); display:flex; flex-direction:column; gap:8px; padding:14px; z-index:4}
.compare.hidden{display:none; pointer-events:none}
.compare-bar{display:flex; align-items:center; gap:10px}
.compare-bar .spacer{flex:1}
.pill{padding:8px 12px;border-radius:999px;border:1px solid var(--line);background:#0b0e13;color:#fff;cursor:pointer}
.pill.danger{border-color:#5a2d2d;background:#221315}
.compare-stage{position:relative;flex:1;border:1px solid var(--line);border-radius:12px;overflow:hidden;background:#0b0e13}
.compare-stage img{position:absolute;inset:0;width:100%;height:100%;object-fit:contain}
.compare-stage #cmpA{z-index:1}
.compare-stage #cmpB{z-index:2;clip-path:inset(0 0 0 var(--split,50%))}
.cmp-range{position:absolute;left:0;right:0;bottom:0;height:36px;background:transparent;z-index:3;-webkit-appearance:none}
.cmp-range::-webkit-slider-runnable-track{height:6px;background:#1b2640;border-radius:999px;margin:14px}
.cmp-range::-webkit-slider-thumb{-webkit-appearance:none;margin-top:-8px;height:22px;width:22px;border-radius:50%;background:#6aa0ff;border:2px solid #2b3857}
.cmp-range::-moz-range-track{height:6px;background:#1b2640;border-radius:999px}
.cmp-range::-moz-range-thumb{height:22px;width:22px;border-radius:50%;background:#6aa0ff;border:2px solid #2b3857}

/* Gallery */
#galleryModal{position:relative;width:min(1600px,98vw);padding:16px 18px 18px;border:none;background:var(--card);color:var(--fg)}
#galleryModal::backdrop{background:#000b}
#galleryModal .icon-close{top:12px;right:14px;z-index:3}
.gallery-head{display:flex;align-items:center;gap:10px;margin:0 12px 8px 12px;padding-right:56px}
.gallery-head h3{margin:0}
.gallery-meta{color:var(--muted);font-size:13px;margin-left:auto}
.gallery-actions{display:flex;gap:8px}
.gallery-progress{display:flex;align-items:center;gap:10px;margin:0 12px 12px 12px}
.gallery-progress progress{width:100%;height:10px;border-radius:999px;overflow:hidden}
.gallery-progress progress::-webkit-progress-bar{background:#0b0e13;border:1px solid var(--line);border-radius:999px}
.gallery-progress progress::-webkit-progress-value{background:linear-gradient(90deg,#3a6cff,#7aa6ff)}
#galleryProgressText{color:var(--muted);min-width:3ch;text-align:right}

.gallery-grid{display:grid;grid-template-columns:repeat(6, minmax(0,1fr));gap:12px;max-height:74vh;overflow:auto;border:1px solid var(--line);border-radius:12px;padding:12px;background:#0b0e13;position:relative;scrollbar-color:#2a3250 #0b0e13}
.gallery-grid::-webkit-scrollbar{width:12px}
.gallery-grid::-webkit-scrollbar-track{background:#0b0e13}
.gallery-grid::-webkit-scrollbar-thumb{background:#2a3250;border-radius:10px}
.gallery-grid .gimg{width:100%;aspect-ratio:1/1;object-fit:cover;border-radius:10px;border:1px solid var(--line)}
.gallery-sentinel{grid-column:1 / -1;padding:10px;text-align:center;color:var(--muted)}

/* Breakpoints: gracefully step down to 4/3/2/1 */
@media (max-width: 1840px){ .grid{ grid-template-columns:repeat(4, 360px); } }
@media (max-width: 1460px){ .grid{ grid-template-columns:repeat(3, 360px); } }
@media (max-width: 1080px){ .grid{ grid-template-columns:repeat(2, 360px); } }
@media (max-width: 740px){  .grid{ grid-template-columns:repeat(1, 360px); } }

/* Favorites */
#toggleFavs.active{outline:2px solid var(--accent)}
.fav-btn{position:absolute;top:10px;right:10px;height:32px;min-width:32px;padding:0 10px;border-radius:999px;border:1px solid var(--line);background:rgba(0,0,0,.50);color:var(--muted);font-size:14px;line-height:30px;cursor:pointer;backdrop-filter:blur(4px);-webkit-backdrop-filter:blur(4px);transition:transform .12s, background .12s, color .12s, border-color .12s}
.fav-btn:hover{transform:translateY(-1px)}
.fav-btn.active{background:#2a2417;color:#ffd76a;border-color:#3a2e1a}
.fav-btn:focus{outline:2px solid var(--accent);outline-offset:2px}

/* Skeleton */
.skel{position:relative;background:linear-gradient(90deg,#0f1320 0%,#141a2a 50%,#0f1320 100%);background-size:200% 100%;animation:sk 1.1s linear infinite}
@keyframes sk{0%{background-position:200% 0}100%{background-position:-200% 0}}
